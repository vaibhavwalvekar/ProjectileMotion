<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Data Visualization Final Assignment</title>
    <script src="http://code.jquery.com/jquery-1.10.2.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" src="d3.js"></script>
    <style>
        .axis path,
        .axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }
        body{ font : 12px sans-serif;}
        .rect { opacity: .7; }
        .axis text {
            font-family: sans-serif;
            font-size: 11px;
        }
    </style>
</head>
<body>
<h1> Projectile Motion</h1>
<div>
    <form>
        Initial Velocity (m/s) :
        <input type="text" name="initialvelocity" id="initialvelocity" value =  100>
        Angle (degree):
        <input type="text" name="angle" id="angle" value = 45>

        Select your planet:
        <select input = "gravity" name="gravity" id="gravity" onclick="removesvgelement()">
            <option value=1.622>Moon</option>
            <option value=3.61>Mercury</option>
            <option value=8.83>Venus</option>
            <option selected value=9.81>Earth</option>
            <option value=3.75>Mars</option>
            <option value=26>Jupiter</option>
            <option value=11.20>Saturn</option>
            <option value=10.50>Uranus</option>
            <option value=13.30>Neptune</option>
            <option value=0.61>Pluto</option>
        </select>
    </form>
    <button onclick="removesvgelement()">Draw</button></div>
<div>
    <form>
        Time of Flight (seconds) :
        <input type="text" name="initialvelocity" readonly>
        Maximum height reached (meters):
        <input type="text" name="angle" id="angle" value = 45>
        Range (meters):
        <select input = "gravity" name="gravity" id="gravity" onclick="removesvgelement()">
        </select>
    </form>
    <script type="text/javascript">
        var w=1300, h=500;
        var padding=30;
        var flighttime;
        var maxHeight;
        var range;
        console.log(angle);
        var svg = d3.select("body")
                .append("svg")
                .attr("width",w)
                .attr("height",h+20);
        createsvgelements();
        function removesvgelement(){
            console.log("Kya bantay");
            d3.selectAll("path").remove();
            createsvgelements()
        }
        function createsvgelements() {
            var xScale = d3.scale.linear()
                    .domain([0, 1000])
                    .range([0, w - 20]);
            var yScale = d3.scale.linear()
                    .domain([100, 0])
                    .range([0, h]);
            var xaxis = d3.svg.axis().scale(xScale).orient("bottom");
            var yaxis = d3.svg.axis().scale(yScale).orient("left");
            svg.append("g")
                    .attr("class", "x axis")
                    .attr("transform", "translate(30," + (h+5) + ")")
                    .call(xaxis)
//                .append("text")
//                .attr("y", 6)
//                .attr("x", 1000)
//                .attr("dy", ".5em")
//                .style("text-anchor", "end");
            svg.append("g")
                    .attr("class", "axis")
                    .attr("transform", "translate(" + padding + ",05)")
                    .call(yaxis)
//                .append("text")
//                .attr("transform", "rotate(-90)")
//                .attr("y", 6)
//                .attr("x", -10)
//                .attr("dy", "0.6em")
//                .style("text-anchor", "end");
            lineData = constructverticalheight(1300);
            console.log(lineData);
            var lineFunction = d3.svg.line()
                    .x(function (d) {
                        return d.x;
                    })
                    .y(function (d) {
                        return d.y;
                    })
                    .interpolate("bundle");
            //The line SVG Path we draw
            var lineGraph = svg.append("path")
                    .attr("d", lineFunction(lineData))
                    .attr("stroke", "blue")
                    .attr("stroke-width", 2)
                    .attr("fill", "none");
        }
        function constructverticalheight(xmax){
            var initialVelocity = document.getElementById("initialvelocity").value;
            console.log(initialVelocity);
            var angle = document.getElementById("angle").value;
            var gravity = document.getElementById("gravity").value;
            var angle = angle*(Math.PI)/180;
            flighttime = ((2 * initialVelocity * Math.sin(angle))/gravity);
            console.log(flighttime);
            maxHeight = (((initialVelocity * initialVelocity) * ((1 - Math.cos(2 * (angle)))/2))/(2 * gravity));
            console.log(maxHeight);
            range = (((initialVelocity * initialVelocity)*(Math.sin(2 * angle)))/gravity)
            console.log(range);
            console.log("Yo bantay");



            var linedata = [];
            x = 50;
            xvalues =[]
            while (x!=xmax){
                xvalues.push(x)
                x+=0.5;
            }
            console.log(xvalues);
            var yvalues = [];
            for (var i = 0; i < xvalues.length; i++)
            {
                var verticalheight = (Math.tan(angle) * i)  - (gravity/(2 * (Math.pow(initialVelocity,2)*((1 + Math.cos(2 * (angle)))/2)))) * (Math.pow(i,2));
                if (verticalheight>20){
                    var d = { "x":xvalues[i] ,   "y": h - verticalheight};
                    yvalues.push(verticalheight);
                    linedata.push(d)}
            }
            console.log(yvalues);
            return linedata;
        }
    </script>
</body>
</html>